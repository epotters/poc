version: "3.4"

services:

  poc-db:
    image: mysql/mysql-server:8.0.13
    container_name: poc-db-dev
    ports:
      - 13306:3306
    volumes:
      - poc-db-data:/var/lib/mysql
    networks:
      - poc-dev
    command: ["mysqld", "--default-authentication-plugin=mysql_native_password"]
    restart: always
    environment:
      ENVIRONMENT: "dev"
      MYSQL_ROOT_HOST: "%"
      MYSQL_DATABASE: "poc_dev"
      MYSQL_USER: "poc_dev"
      MYSQL_PASSWORD: "b1vidh"


  poc-web-api:
    image: epotters/poc-web-api:0.1-SNAPSHOT
    container_name: poc-web-api-dev
    ports:
      - 18002:8002
    networks:
      - poc-dev
    restart: always
    depends_on:
      - poc-db
    environment:
      ENVIRONMENT: "dev"
      SPRING_DATASOURCE_URL: "jdbc:mysql://poc-db:3306/poc_dev?useSSL=false&serverTimezone=Europe/Amsterdam"


volumes:
  poc-db-data:


networks:
  poc-dev: